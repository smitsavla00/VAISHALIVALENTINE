<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>For You üíò</title>
  <meta name="description" content="A tiny romantic website made with love."/>
  <style>
    :root{
      --bg1:#ffe4ec;
      --bg2:#e5d9ff;
      --bg3:#d8f4ff;
      --card:rgba(255,255,255,.62);
      --card-border:rgba(255,255,255,.40);
      --text:#1b1b2a;
      --muted:#4b4b63;
      --pink:#e11d48;
      --rose:#fb7185;
      --lav:#a78bfa;
      --ink:#111827;
      --shadow: 0 24px 70px rgba(0,0,0,.18);
      --r: 22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      min-height:100vh;
      color:var(--text);
      overflow-x:hidden;
      overflow-y:auto;
      background:
        radial-gradient(1200px 800px at 18% 20%, rgba(255,255,255,.70), transparent 60%),
        radial-gradient(950px 720px at 82% 35%, rgba(255,255,255,.52), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2) 55%, var(--bg3));
    }

    body:before{
      content:"";
      position:fixed; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.12'/%3E%3C/svg%3E");
      opacity:.35;
      pointer-events:none;
      mix-blend-mode: soft-light;
    }

    .heart{
      position:fixed;
      left:var(--x);
      top:110vh;
      width:14px;height:14px;
      transform: rotate(45deg);
      background: rgba(225,29,72,.55);
      opacity:.85;
      filter: drop-shadow(0 8px 14px rgba(0,0,0,.14));
      animation: floatUp var(--d) linear infinite;
      pointer-events:none;
    }
    .heart::before,.heart::after{
      content:"";
      position:absolute;
      width:14px;height:14px;
      background: inherit;
      border-radius: 50%;
    }
    .heart::before{left:-7px;top:0}
    .heart::after{left:0;top:-7px}
    @keyframes floatUp{
      0%{ transform: translateY(0) rotate(45deg) scale(.9); opacity:0}
      10%{opacity:.88}
      100%{ transform: translateY(-240vh) rotate(45deg) scale(1.25); opacity:0}
    }

    canvas{position:fixed; inset:0; pointer-events:none}

    .wrap{
      position:relative;
      min-height:100svh;
      display:grid;
      place-items:center;
      padding:24px;
    }
    @media (max-width: 520px){
      .wrap{ padding:16px; place-items:start center; }
    }

    .card{
      width:min(720px, 94vw);
      backdrop-filter: blur(12px);
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 26px 22px;
      position:relative;
      overflow-x:hidden;
      overflow-y:auto;
    }

    .topRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,.65);
      border: 1px solid rgba(255,255,255,.45);
      font-weight: 800;
    }
    .small{
      font-size: 12px;
      color: rgba(27,27,42,.75);
    }

    .controls{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;
    }
    @media (max-width: 520px){
      .topRow{ flex-direction:column; align-items:stretch; }
      .controls{ justify-content:center; }
      .pill{ justify-content:center; }
      .iconBtn{ padding: 10px 14px; }
    }
    .iconBtn{
      border: 1px solid rgba(17,24,39,.16);
      background: rgba(255,255,255,.55);
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 800;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .iconBtn:hover{ filter: brightness(1.04) }
    .iconBtn:active{ transform: translateY(1px) }

    h1{
      margin: 8px 0 10px;
      font-size: clamp(24px, 4.5vw, 36px);
      line-height:1.15;
      letter-spacing:.2px;
      text-align:center;
      text-shadow: 0 1px 0 rgba(255,255,255,.55);
    }
    p{
      margin:0 0 14px;
      color:var(--muted);
      font-size: 15px;
      text-align:center;
    }

    .typeLine{
      display:inline-block;
      border-right: 2px solid rgba(27,27,42,.45);
      padding-right: 6px;
      animation: caret 700ms steps(1) infinite;
    }
    @keyframes caret{ 50%{ border-right-color: transparent } }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
      margin-top: 16px;
    }
    @media (max-width: 820px){
      .grid{ grid-template-columns:1fr; }
    }

    .panel{
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(255,255,255,.42);
      border-radius: 18px;
      padding: 16px 14px;
      box-shadow: 0 16px 36px rgba(0,0,0,.10);
    }

    .panel h2{
      margin:0 0 10px;
      font-size: 16px;
      letter-spacing:.2px;
      color: rgba(27,27,42,.92);
      display:flex; align-items:center; gap:8px;
    }
    .list{
      display:grid;
      gap:10px;
      margin-top: 8px;
    }
    .chip{
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.62);
      border: 1px solid rgba(17,24,39,.10);
      color: rgba(27,27,42,.88);
      font-weight:700;
      text-align:left;
    }

    
    /* Single-photo carousel (one at a time) */
    .carousel{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
      margin-top: 10px;
    }
    .carouselViewport{
      width:100%;
      max-width: 520px;
      height: 320px;
      border-radius: 18px;
      overflow:hidden;
      position:relative;
      background: rgba(255,255,255,.35);
      border: 1px solid rgba(255,255,255,.45);
      box-shadow: 0 18px 40px rgba(0,0,0,.10);
    }
    .carouselSlide{
      position:absolute;
      inset:0;
      padding: 12px;
      opacity:0;
      transform: translateX(18px) scale(.99);
      transition: opacity .55s ease, transform .55s ease;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .carouselSlide.active{
      opacity:1;
      transform: translateX(0) scale(1);
      z-index:2;
    }
    .carouselSlide img{
      width:100%;
      height:100%;
      object-fit:cover;
      border-radius: 14px;
      display:block;
      transform: scale(1.01);
    }
    .carouselCaption{
      position:absolute;
      left: 18px;
      right: 18px;
      bottom: 18px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.85);
      border: 1px solid rgba(255,255,255,.55);
      font-weight: 900;
      font-size: 13px;
      color: rgba(27,27,42,.9);
      text-align:center;
      box-shadow: 0 10px 24px rgba(0,0,0,.08);
      opacity: 0;
      transform: translateY(6px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .carouselViewport:hover .carouselCaption{
      opacity:1;
      transform: translateY(0);
    }
    .carouselDots{
      display:flex;
      gap:8px;
      justify-content:center;
      align-items:center;
    }
    .carouselDot{
      width:10px;
      height:10px;
      border-radius: 999px;
      background: rgba(27,27,42,.14);
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
    }
    .carouselDot.active{
      background: linear-gradient(135deg, var(--pink), var(--rose));
      transform: scale(1.25);
      box-shadow: 0 10px 18px rgba(225,29,72,.18);
    }
    @media (max-width: 520px){
      .carouselViewport{ height: 220px; border-radius: 16px; }
      .carouselSlide img{ border-radius: 12px; }
      .carouselCaption{ font-size: 12px; left: 14px; right: 14px; bottom: 14px; }
    }
.btnRow{
      margin-top: 22px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:24px;
      flex-wrap:wrap;
      position:relative;
      min-height: 80px;
    }
    button{
      border:0;
      border-radius: 999px;
      padding: 12px 18px;
      font-weight: 900;
      font-size: 15px;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    button:active{ transform: translateY(1px) scale(.99) }
    .yes{
      background: linear-gradient(135deg, var(--pink), var(--rose));
      color:white;
      box-shadow: 0 18px 36px rgba(225,29,72,.35);
      padding: 18px 30px;
      font-size: 19px;
      z-index: 2;
    }
    .yes:hover{ filter: brightness(1.04) }
    .no{
      background: rgba(17,24,39,.08);
      border: 1px solid rgba(17,24,39,.18);
      color: rgba(17,24,39,.85);
      padding: 8px 12px;
      font-size: 13px;
      box-shadow: 0 8px 14px rgba(0,0,0,.09);
      position: relative; /* participate in flex layout */
      transform: none;    /* we'll move it via translate() only */
      margin-left: 6px;
      z-index: 1;
      touch-action: manipulation;
    }

    .modalBackdrop{
      position:fixed; inset:0;
      background: rgba(10,10,20,.22);
      display:none;
      place-items:center;
      padding: 18px;
      z-index: 50;
      backdrop-filter: blur(6px);
    }
    .modal{
      width:min(560px, 95vw);
      background: rgba(255,255,255,.72);
      border: 1px solid rgba(255,255,255,.45);
      border-radius: 22px;
      box-shadow: 0 26px 80px rgba(0,0,0,.20);
      padding: 18px 16px;
      position:relative;
    }
    .modal h3{ margin: 4px 0 10px; text-align:center; }
    .modal p{ text-align:center; margin-bottom:12px; white-space:pre-wrap; }
    .close{
      position:absolute; top:10px; right:10px;
      border: 1px solid rgba(17,24,39,.16);
      background: rgba(255,255,255,.60);
      border-radius: 999px;
      padding: 8px 10px;
      font-weight: 900;
      cursor:pointer;
    }

    .success{
      display:none;
      animation: popIn .35s ease both;
      text-align:center;
    }
    @keyframes popIn{
      from{ transform: translateY(10px) scale(.98); opacity:0 }
      to{ transform: translateY(0) scale(1); opacity:1 }
    }
    .bigLove{
      font-size: clamp(22px, 4.5vw, 34px);
      font-weight: 1000;
      margin-top: 2px;
    }
    .media{
      margin: 14px auto 10px;
      width:min(520px, 96%);
      border-radius: 18px;
      overflow-x:hidden;
      overflow-y:auto;
      border: 1px solid rgba(255,255,255,.45);
      box-shadow: 0 20px 48px rgba(0,0,0,.18);
      background: rgba(255,255,255,.35);
    }
    .media img, .media video{ width:100%; display:block; }
    .fromLine{ margin-top: 10px; font-weight: 900; color: rgba(27,27,42,.85); }

    .hint{
      margin-top: 12px;
      opacity:.85;
      font-size: 12.5px;
      text-align:center;
    }
    code{background: rgba(255,255,255,.55); padding:2px 6px; border-radius:8px}
  
    /* NO click overlay video (plays once like a gif) */
    #noGifOverlay{
      pointer-events: none;
      position: fixed;
      right: 18px;
      bottom: 18px;
      width: min(360px, 86vw);
      aspect-ratio: 16 / 9;
      border-radius: 18px;
      overflow: hidden;
      background: rgba(255,255,255,.60);
      border: 1px solid rgba(255,255,255,.50);
      box-shadow: 0 22px 60px rgba(0,0,0,.22);
      z-index: 60;
      backdrop-filter: blur(10px);
      transform: translateY(12px) scale(.98);
      opacity: 0;
      transition: opacity .22s ease, transform .22s ease;
    }
    #noGifOverlay.show{
      pointer-events: auto;
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    #noGifOverlay video{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display:block;
    }
    #noGifClose{
      position:absolute;
      top:10px;
      right:10px;
      border: 1px solid rgba(17,24,39,.16);
      background: rgba(255,255,255,.75);
      border-radius: 999px;
      padding: 6px 10px;
      font-weight: 1000;
      cursor:pointer;
      z-index: 2;
    }
    #noGifLabel{
      position:absolute;
      left:12px;
      bottom:12px;
      padding: 8px 10px;
      border-radius: 14px;
      background: rgba(255,255,255,.85);
      border: 1px solid rgba(255,255,255,.60);
      font-weight: 1000;
      font-size: 13px;
      color: rgba(27,27,42,.92);
      z-index: 2;
      max-width: calc(100% - 24px);
      text-align:left;
    }
    @media (max-width: 520px){
      #noGifOverlay{
      pointer-events: none;
        right: 12px;
        bottom: 12px;
        width: min(340px, 92vw);
        border-radius: 16px;
      }
      #noGifLabel{ font-size: 12.5px; }
    }

/* Mobile alignment polish */
    @media (max-width: 520px){
      .wrap{ padding:14px; }
      .card{ padding:16px 12px; border-radius:18px; }
      h1{ font-size: 24px; }
      p{ font-size: 14px; }
      .bigQuestion{ font-size: 20px; line-height:1.15; }
      .grid{ gap:12px; margin-top:14px; }
      .panel{ padding:14px 12px; border-radius:16px; }
      .controls{ gap:8px; justify-content:center; }
      .iconBtn{ padding:10px 14px; }
      .btnRow{ min-height: 76px; gap:18px; margin-top:18px; }
      .yes{ padding:16px 26px; font-size:18px; }
      .no{ font-size:12px; padding:8px 10px; }
      .media{ width: 100%; }
    }

  
    /* Intro gate overlay */
    #introGate{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      padding:18px;
      z-index: 70;
      background: radial-gradient(900px 600px at 20% 20%, rgba(255,255,255,.75), rgba(255,255,255,.35) 55%, rgba(10,10,20,.22));
      backdrop-filter: blur(10px);
    }
    .introCard{
      width:min(520px, 92vw);
      border-radius: 24px;
      background: rgba(255,255,255,.72);
      border: 1px solid rgba(255,255,255,.50);
      box-shadow: 0 28px 90px rgba(0,0,0,.22);
      padding: 18px 16px;
      text-align:center;
    }
    .introTitle{
      font-weight: 1000;
      font-size: 22px;
      margin: 6px 0 10px;
      color: rgba(27,27,42,.92);
    }
    .introText{
      color: rgba(27,27,42,.78);
      font-weight: 800;
      line-height: 1.45;
      margin: 0 0 14px;
      font-size: 15px;
    }
    .introBtn{
      border:0;
      border-radius: 999px;
      padding: 14px 22px;
      font-weight: 1000;
      cursor:pointer;
      background: linear-gradient(135deg, var(--pink), var(--rose));
      color: white;
      box-shadow: 0 18px 40px rgba(225,29,72,.32);
      transition: transform .12s ease, filter .12s ease;
    }
    .introBtn:hover{ filter: brightness(1.04); }
    .introBtn:active{ transform: translateY(1px) scale(.99); }
    .introHint{
      margin-top: 10px;
      font-size: 12px;
      color: rgba(27,27,42,.62);
      font-weight: 800;
    }

  </style>
</head>

<body>
  <canvas id="confetti"></canvas>

  <div id="noGifOverlay" style="display:none; pointer-events:none;">
    <button id="noGifClose" aria-label="Close">‚úï</button>
    <div id="noGifLabel">üòÇ Bhagwan se daroo beti</div>
    <video id="noGifVid" playsinline muted preload="auto"></video>
  </div>


  <!-- Sweet intro gate (required for reliable music start on mobile) -->
  <div id="introGate" role="dialog" aria-modal="true" aria-label="Welcome" >
    <div class="introCard">
      <div class="introTitle">Hey love üíñ</div>
      <div class="introText">
        I made this little page for you.<br/>
        Take a deep breath‚Ä¶ and press the button. üé∂
      </div>
      <button id="introStart" class="introBtn">Start the magic ‚ú®</button>
      <div class="introHint">Music starts after you tap (phone rules üòå)</div>
    </div>
  </div>


  <div class="modalBackdrop" id="modalBackdrop">
    <div class="modal">
      <button class="close" id="closeModal">‚úï</button>
      <h3>üíå A little love letter</h3>
      <p id="letterText"></p>
      
    </div>
  </div>

    <audio id="bgAudio" preload="auto" loop playsinline></audio>

  <div class="wrap" id="mainContent">
    <div class="card" id="card">

      <div class="topRow">
        <div class="pill">üíò My Valentine Vaishali<span class="small" id="dateLabel"></span></div>
        <div class="controls">
          <button class="iconBtn" id="musicBtn" title="Play / pause music">üéµ Music</button>
          <button class="iconBtn" id="letterBtn" title="Open love letter">üíå Letter</button>
          <button class="iconBtn" id="surpriseBtn" title="Tiny surprise">üéÅ Surprise</button>
        </div>
      </div>

      <h1>
        <span id="name">HerName</span>,
        <br/>
        <span class="typeLine" id="typeLine">I have something cute to ask you‚Ä¶</span>
      </h1>
      <p id="sub">If you smile right now, my mission is already successful üòåüíó</p>
      <p class="bigLove" style="margin-top:14px;">
        Will you be my Valentine <span style="color:#e11d48;">for the rest of my life</span>? üíçüíñ
      </p>


      <div id="ask">
        <div class="grid">
          <div class="panel">
            <h2>‚ú® Reasons I adore you</h2>
            <div class="list" id="reasons"></div>
          </div>

          <div class="panel">
            <h2>üì∏ Us (mini gallery)</h2>
            <p class="small" style="text-align:left;margin:0 0 8px;">
              Our little moments üíû
            </p>
            <div class="carousel" id="carousel" aria-label="Photo carousel">
              <div class="carouselViewport" id="carouselViewport"></div>
              <div class="carouselDots" id="carouselDots"></div>
            </div>
          </div>
        </div>

        <div class="btnRow" id="btnRow">
          <button class="yes" id="yesBtn">YES üíñ</button>
          <button class="no" id="noBtn" aria-label="No">No üò∂</button>
        </div>

        
      </div>

      <div id="yay" class="success" aria-live="polite">
        <div class="pill" style="justify-content:center;">üíñ SHE SAID YES üíñ</div>
        <div class="bigLove">Okay‚Ä¶ now you‚Äôre officially my Valentine üòò</div>
        <p id="yaySub">I‚Äôm planning rest of life with you which you‚Äôll never forget üåô‚ú®</p>

        <div class="media">
          <video id="successVid" playsinline controls preload="auto" style="background:rgba(255,255,255,.25)"></video>
        </div>

        <div class="fromLine">‚Äî love, <span id="from">YourName</span> ‚ù§Ô∏è</div>
        <p class="small" id="shareHint" style="margin-top:8px;">Now send this link to me with ‚ÄúI said YES üòåüíó‚Äù</p>
      </div>
    </div>
  </div>

  <script>
    const CONFIG = {
      herName: "Vaishali",
      yourName: "Smit",
      typedLines: [
        "I have something cute to ask you‚Ä¶",
        "You + me = my favorite plan üíó",
        "Warning: this page contains too much love üòÑ"
      ],
      subText: "If you smile right now, my mission is already successful üòåüíó",
      reasons: [
        "Your smile fixes my bad days instantly.",
        "You make my heartbeat skip sometimes.",
        "You make simple moments feel special.",
        "You‚Äôre kind, strong, and ridiculously adorable.",
        "You feel like home to me."
      ],
      photos: ["assest/Snapchat-471822461.jpg","assest/500072700782_180496.jpg","assest/500078700516_59864.jpg","assest/500079900176_174194.jpg","assest/1770697408756.JPG","assest/1770698173757.jpg"],
      photoMessages: [
        "My favorite memory ‚ù§Ô∏è",
        "You + me = magic ‚ú®",
        "Forever looks good on us üíç",
        "Smiles that I want forever üòä",
        "Every moment with you feels special üíñ",
        "Us‚Ä¶ always and forever ü´∂"
      ],
      successImage: "assest/1770697408756.JPG",
      successVideo: "assest/vid-20260210114633-0xm3t1bs_NzxeNEWV.mp4",
      noClickVideo: "assest/VID-20230722-WA0000.mp4",
      yaySubText: "I‚Äôm planning a date you‚Äôll never forget üåô‚ú®",
      loveLetter:
        "Hey love,\n\nI just wanted you to know‚Ä¶ you‚Äôre my favorite part of every day. " +
        "Thank you for choosing me, understanding me, and making life sweeter.\n\n" +
        "Will you be my Valentine and keep being my forever person? üíò",
      musicFile: "assest/Main Rang Sharbaton Ka Phata Poster Nikhla Hero 320 Kbps.mp3"
    };

    const $ = (id) => document.getElementById(id);

    $("name").textContent = CONFIG.herName;
    $("from").textContent = CONFIG.yourName;
    $("sub").textContent = CONFIG.subText;
    $("yaySub").textContent = CONFIG.yaySubText;
    $("letterText").textContent = CONFIG.loveLetter;

    const now = new Date();
    $("dateLabel").textContent = "‚Ä¢ " + now.toLocaleDateString(undefined, { weekday:"short", month:"short", day:"numeric" });

    const reasonsEl = $("reasons");
    reasonsEl.innerHTML = "";
    for (const r of CONFIG.reasons){
      const div = document.createElement("div");
      div.className = "chip";
      div.textContent = "üíó " + r;
      reasonsEl.appendChild(div);
    }

    const galleryViewport = $("carouselViewport");
    const carouselDots = $("carouselDots");

    const photos = Array.isArray(CONFIG.photos) ? CONFIG.photos.slice() : [];
    const captions = Array.isArray(CONFIG.photoMessages) ? CONFIG.photoMessages.slice() : [];

    let slides = [];
    if (galleryViewport && carouselDots) {
      galleryViewport.innerHTML = "";
      carouselDots.innerHTML = "";
      slides = [];

      for (let i = 0; i < photos.length; i++) {
        const slide = document.createElement("div");
        slide.className = "carouselSlide";

        const img = document.createElement("img");
        img.src = encodeURI(photos[i]);
        img.alt = "Us photo " + (i + 1);
        slide.appendChild(img);

        const cap = document.createElement("div");
        cap.className = "carouselCaption";
        cap.textContent = captions[i] || "Our moment üíó";
        slide.appendChild(cap);

        galleryViewport.appendChild(slide);
        slides.push(slide);

        const dot = document.createElement("div");
        dot.className = "carouselDot";
        dot.addEventListener("click", () => {
          setActive(i);
          resetAutoplay();
        });
        carouselDots.appendChild(dot);
      }
    }

    let active = 0;
    function setActive(i) {
      if (!slides.length) return;
      slides.forEach((s, idx) => s.classList.toggle("active", idx === i));
      const dots = carouselDots.querySelectorAll(".carouselDot");
      dots.forEach((d, idx) => d.classList.toggle("active", idx === i));
      active = i;
    }
    setActive(0);

    let timer = null;
    function startAutoplay() {
      if (!slides.length) return;
      timer = setInterval(() => {
        active = (active + 1) % slides.length;
        setActive(active);
      }, 5000);
    }
    function resetAutoplay() {
      if (timer) clearInterval(timer);
      startAutoplay();

    // autoplay removed (intro gate handles start)
    }
    startAutoplay();

    // autoplay removed (intro gate handles start)

    // Pause autoplay while hovering (desktop)
    if (galleryViewport) {
      galleryViewport.addEventListener("mouseenter", () => { if (timer) clearInterval(timer); });
      galleryViewport.addEventListener("mouseleave", () => resetAutoplay());
    }

    const typeEl = $("typeLine");
    const lines = (CONFIG.typedLines && CONFIG.typedLines.length) ? CONFIG.typedLines : ["I have something cute to ask you‚Ä¶"];
    let lineIdx = 0, charIdx = 0, deleting = false;

    function typeTick(){
      const current = lines[lineIdx];
      if (!deleting){
        charIdx++;
        typeEl.textContent = current.slice(0, charIdx);
        if (charIdx >= current.length){
          deleting = true;
          setTimeout(typeTick, 1400);
          return;
        }
      } else {
        charIdx--;
        typeEl.textContent = current.slice(0, Math.max(0,charIdx));
        if (charIdx <= 0){
          deleting = false;
          lineIdx = (lineIdx + 1) % lines.length;
        }
      }
      setTimeout(typeTick, deleting ? 35 : 45);
    }
    setTimeout(typeTick, 700);

    const successVid = $("successVid");
    if (successVid && CONFIG.successVideo){
      successVid.src = encodeURI(CONFIG.successVideo);
    }

    const noBtn = $("noBtn");
    const yesBtn = $("yesBtn");
    const btnRow = $("btnRow");
    let noCount = 0;

    function moveNoButton(){
      // Move the NO button using translate so it NEVER overlaps the YES button in layout.
      // We constrain movement to the right side of the button row.
      const rowRect = btnRow.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();

      // Right-side playground (in px)
      const rightZoneWidth = Math.max(90, rowRect.width * 0.35);
      const maxX = Math.max(0, rightZoneWidth - btnRect.width);
      const maxY = 34;

      const x = Math.floor(Math.random() * (maxX + 1));
      const y = Math.floor((Math.random() * 2 - 1) * maxY);

      noBtn.style.transform = `translate(${x}px, ${y}px)`;
    }

    btnRow.style.position = "relative";
    // noBtn.style.position = "absolute"; (removed)
    // noBtn.style.top = "0px"; (removed)
    // noBtn.style.left = "52%"; (removed)

    // hover disabled on purpose üòÑ
    noBtn.addEventListener("touchstart", (e) => { noCount++; showNoGifOnce(); moveNoButton(); updateNoText(); e.preventDefault(); }, {passive:false});
    // iOS Safari sometimes ignores touchstart handlers if the finger moves slightly; touchend as backup
    noBtn.addEventListener("touchend", (e) => { noCount++; showNoGifOnce(); moveNoButton(); updateNoText(); e.preventDefault(); }, {passive:false});
    noBtn.addEventListener("click", (e) => { noCount++; showNoGifOnce(); moveNoButton(); updateNoText(); e.preventDefault(); });

    function showNoGifOnce(){
      const overlay = document.getElementById("noGifOverlay");
      const v = document.getElementById("noGifVid");
      if (!overlay || !v || !CONFIG.noClickVideo) return;

      // Root cause fixed:
      // 1) We were calling play() before the video was ready (slow load / iOS) -> blank.
      // 2) A hardcoded 5200ms timeout could hide the overlay before the clip actually appears.
      // Fix: load() + wait for data, and hide based on duration/onended.

      // Clear any previous timers/handlers (important when user taps NO multiple times)
      if (window.__noGifHideTimer) clearTimeout(window.__noGifHideTimer);
      v.onended = null;
      v.onloadeddata = null;
      v.onloadedmetadata = null;

      // Show overlay
      overlay.style.display = "block";
      overlay.style.pointerEvents = "auto";
      requestAnimationFrame(() => overlay.classList.add("show"));

      const closeBtn = document.getElementById("noGifClose");
      if (closeBtn){
        closeBtn.onclick = () => {
          overlay.classList.remove("show");
          setTimeout(() => {
            overlay.style.display = "none";
            overlay.style.pointerEvents = "none";
          }, 180);
        };
      }

      // Reset & load video deterministically
      try { v.pause(); } catch(e){}
      v.loop = false;
      v.muted = true;

      const targetSrc = encodeURI(CONFIG.noClickVideo);
      if (v.src !== targetSrc) v.src = targetSrc;

      // Force reload so first frame shows reliably
      v.load();

      const startPlayback = () => {
        try { v.currentTime = 0; } catch(e){}
        const p = v.play();
        if (p && p.catch) p.catch(()=>{});
      };

      // Once enough data is available, play
      v.onloadeddata = () => startPlayback();

      // Hide when ended (preferred)
      v.onended = () => {
        overlay.classList.remove("show");
        setTimeout(() => {
          overlay.style.display = "none";
          overlay.style.pointerEvents = "none";
        }, 180);
      };

      // Safety hide based on actual duration (no more hardcoded 5.2s)
      // Keep it visible at least 2.2s, and at most 12s.
      v.onloadedmetadata = () => {
        const durMs = isFinite(v.duration) ? (v.duration * 1000) : 6500;
        const hideAfter = Math.max(2200, Math.min(12000, durMs + 250));
        window.__noGifHideTimer = setTimeout(() => {
          overlay.classList.remove("show");
          setTimeout(() => {
            overlay.style.display = "none";
            overlay.style.pointerEvents = "none";
          }, 4000);
        }, hideAfter);
      };
    }

    function updateNoText(){
      const lines = [
        "No üôÑ",
        "Nice try üòè",
        "This is illegal üòÇ",
        "Wrong button üòå",
        "Try YES üëâüíñ",
        "Are you joking? üòÜ",
        "This is illegal üòÇ",
        "Nice finger, wrong choice üòù",
        "Universe says YES üåå",
        "Fate won‚Äôt allow this üòà",
        "Still pressing NO? üò≥",
        "Plot twist: YES wins üí•",
        "Heart says YES ‚ù§Ô∏è",
        "Okay enough, click YES üòåüíñ"
      ];
      noBtn.textContent = lines[Math.min(noCount, lines.length-1)];
    }

    yesBtn.addEventListener("click", () => {
      $("ask").style.display = "none";
      $("yay").style.display = "block";

      const v = $("successVid");
      if (v && CONFIG.successVideo){
        v.loop = true;
        v.muted = false; // user gesture allows sound
        v.play().catch(()=>{});
      }

      launchConfetti(320);
      burstHearts(24);
      sparklePulse();
    });

    const modalBackdrop = $("modalBackdrop");
    $("letterBtn").addEventListener("click", () => {
      modalBackdrop.style.display = "grid";
      burstHearts(10);
    });
    $("closeModal").addEventListener("click", () => modalBackdrop.style.display = "none");
    modalBackdrop.addEventListener("click", (e) => { if (e.target === modalBackdrop) modalBackdrop.style.display = "none"; });

    $("surpriseBtn").addEventListener("click", () => {
      burstHearts(22);
      launchConfetti(180);
      const prev = typeEl.textContent;
      typeEl.textContent = "You are my favorite ‚ÄúYES‚Äù üíñ";
      setTimeout(() => typeEl.textContent = prev, 1800);
    });

    
    function autoplayBgMusic(){
      const el = document.getElementById("bgAudio");
      if (!el || !CONFIG.musicFile) return;
      el.src = encodeURI(CONFIG.musicFile);
      el.volume = 0.65;
      el.muted = true; // allow autoplay
      el.play().catch(()=>{});

      const unlock = () => {
        el.muted = false;
        el.play().catch(()=>{});
        window.removeEventListener("pointerdown", unlock);
        window.removeEventListener("touchstart", unlock);
      };
      window.addEventListener("pointerdown", unlock, { once:true });
      window.addEventListener("touchstart", unlock, { once:true, passive:true });
    }

    let playing = false;
    const bg = document.getElementById("bgAudio");

    function setMusicUI(){
      const b = $("musicBtn");
      if (b) b.textContent = playing ? "‚è∏Ô∏è Music" : "üéµ Music";
    }

    function ensureBgSrc(){
      if (!bg || !CONFIG.musicFile) return;
      if (!bg.src) bg.src = encodeURI(CONFIG.musicFile);
      bg.loop = true;
      bg.volume = 0.65;
    }

    function startMusic(){
      ensureBgSrc();
      if (!bg) return;
      // Resume from where it stopped (currentTime preserved by default)
      return bg.play().then(() => {
        playing = true;
        setMusicUI();
      }).catch(() => {
        playing = false;
        setMusicUI();
      });
    }

    function pauseMusic(){
      if (!bg) return;
      bg.pause(); // keeps currentTime for resume
      playing = false;
      setMusicUI();
    }

    // Music button toggle
    const musicBtn = $("musicBtn");
    if (musicBtn){
      musicBtn.addEventListener("click", () => {
        if (!playing) startMusic(); else pauseMusic();
        burstHearts(6);
      });
    }

    // Keep UI in sync if browser/OS pauses it
    if (bg){
      bg.addEventListener("play", () => { playing = true; setMusicUI(); });
      bg.addEventListener("pause", () => { playing = false; setMusicUI(); });
    }

    // Intro popup gate (required for reliable autoplay on mobile)
    const introGate = document.getElementById("introGate");
    const introStart = document.getElementById("introStart");
    const mainContent = document.getElementById("mainContent");

    function openIntro(){
      if (introGate){
        introGate.style.display = "grid";
        introGate.style.pointerEvents = "auto";
      }
      if (mainContent) mainContent.style.filter = "blur(10px)";
    }

    function closeIntro(){
      if (introGate){
        introGate.style.display = "none";
        introGate.style.pointerEvents = "none";
      }
      if (mainContent) mainContent.style.filter = "none";
    }

    // Always show gate on load
    openIntro();

    if (introStart){
      introStart.addEventListener("click", (e) => {
        e.preventDefault();
        e.stopPropagation();
        closeIntro();
        startMusic(); // user gesture makes it start reliably
        burstHearts(10);
      });
    }

    setMusicUI();

    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      h.style.setProperty("--x", Math.floor(Math.random()*100) + "vw");
      h.style.setProperty("--d", (7 + Math.random()*6).toFixed(2) + "s");
      const a = (0.35 + Math.random()*0.45).toFixed(2);
      const palette = [
        `rgba(225,29,72,${a})`,
        `rgba(251,113,133,${a})`,
        `rgba(167,139,250,${a})`
      ];
      h.style.background = palette[Math.floor(Math.random()*palette.length)];
      document.body.appendChild(h);
      setTimeout(() => h.remove(), 14000);
    }
    for (let i=0;i<14;i++) setTimeout(spawnHeart, i*360);
    setInterval(spawnHeart, 720);

    function burstHearts(n){
      for (let i=0;i<n;i++) setTimeout(spawnHeart, i*60);
    }

    const canvas = $("confetti");
    const ctx = canvas.getContext("2d");
    let W, H, confetti = [], running = false;

    function resize(){
      W = canvas.width = window.innerWidth * devicePixelRatio;
      H = canvas.height = window.innerHeight * devicePixelRatio;
    }
    window.addEventListener("resize", resize);
    resize();

    function launchConfetti(count){
      confetti = [];
      for (let i=0;i<count;i++){
        confetti.push({
          x: (Math.random()*W),
          y: (-20 - Math.random()*H*0.2),
          vx: (-1 + Math.random()*2) * devicePixelRatio * 3.2,
          vy: (2 + Math.random()*5) * devicePixelRatio * 2.4,
          r: (2 + Math.random()*4.2) * devicePixelRatio,
          a: Math.random() * Math.PI * 2,
          va: (-0.2 + Math.random()*0.4),
          c: ["#e11d48","#fb7185","#f472b6","#a78bfa","#fda4af","#ffffff"][Math.floor(Math.random()*6)],
          life: 190 + Math.random()*90
        });
      }
      if (!running){
        running = true;
        requestAnimationFrame(tick);
      }
    }

    function tick(){
      ctx.clearRect(0,0,W,H);
      let alive = 0;

      for (const p of confetti){
        if (p.life <= 0) continue;
        alive++;
        p.life -= 1;
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.03 * devicePixelRatio;
        p.a += p.va;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.a);
        ctx.fillStyle = p.c;
        ctx.globalAlpha = Math.min(1, p.life/90);
        ctx.fillRect(-p.r, -p.r, p.r*2.3, p.r*2.3);
        ctx.restore();
      }

      if (alive > 0) requestAnimationFrame(tick);
      else running = false;
    }

    function sparklePulse(){
      const card = $("card");
      card.animate([
        { filter:"brightness(1)", transform:"translateY(0)" },
        { filter:"brightness(1.06)", transform:"translateY(-2px)" },
        { filter:"brightness(1)", transform:"translateY(0)" }
      ], { duration: 700, iterations: 2, easing:"ease-in-out" });
    }

    requestAnimationFrame(() => moveNoButton());
  </script>
</body>
</html>
